setwd("~/Documents/Research/Workshops/IRRI_2025/Module2/Module2_Upload")
list.files()
library(knitr)
purl("Calculate and Visualize LD in R.Rmd",
output = "Calculate and Visualize LD in R.Rmd")
purl("Relationship Matrices in Crop Genetic.Rmd",
output = "Relationship Matrices in Crop Genetic.R")
list.files()
purl("Understanding Ridge Regression in R.Rmd",
output = "Understanding Ridge Regression in R.R")
purl("Disecting_Mixed_model_Equation.Rmd",
output = "Disecting_Mixed_model_Equation.R")
library(knitr)
purl("Calculate and Visualize LD in R.Rmd",
output = "Calculate and Visualize LD in R.R")
setwd("~/Documents/Research/Workshops/IRRI_2025/Module2/Module2_Upload")
library(knitr)
purl("Calculate and Visualize LD in R.Rmd",
output = "Calculate and Visualize LD in R.R")
rm(list=ls()) # remove the previous history
# Install
#install.packages("BGLR")
#install.packages("genetics")
# Installing snpStats package from Bioconuctor
#if (!requireNamespace("BiocManager", quietly = TRUE))
#install.packages("BiocManager")
#BiocManager::install("snpStats")
# Load the packages
library(BGLR)
library(genetics)
library(pheatmap)
# Read the mice marker data
mice.X<-read.csv(file="mice.X.csv", header = TRUE)
setwd("~/Documents/Research/Workshops/IRRI_2025/Module2/Module2_Upload")
setwd("~/Documents/Research/Workshops/IRRI_2025/Module2/Module2_Upload")
# Load the mice data
data(mice)
setwd("~/Documents/Research/Workshops/IRRI_2025/Module2/Module2_Upload/Data")
# Read the mice marker data
mice.X<-read.csv(file="mice.X.csv", header = TRUE)
View(mice.X)
View(mice.X)
# Subset the mice data, first 20 markers
mice.20<- mice.X[, 1:20] # use the first 10 markers
# Visualize first 5 rows and columns
mice.20[1:5, 1:5] # Data is coded 0, 1 and 2
# Make genotypes
mice.20.G<- makeGenotypes(mice.20, convert=c(colnames(mice.20)),
method=as.genotype.allele.count)
View(mice.20.G)
# Visualize first 5 rows and columns
mice.20.G[1:5, 1:5] # Data is coded 0, 1 and 2
# Now calculate the LD
LD.20<- LD(mice.20.G) # This will return the list
LD.20
names (LD.20)
# Extract r2 ( Hill and Robertson (1968)
r2<-LD.20$`R^2`
View(r2)
# Copy upper part of matrix to lower for visualizations
lowerTriangle(r2) <- upperTriangle(r2)
View(r2)
diag(r2)
# Convert Diagonal to 1
diag(r2)<-1
diag(r2)
heatmap(r2)
ld.map<-heatmap(r2)
ld.map
#install.packages("AGHmatrix")
library ("AGHmatrix")
library(DT)
help("Amatrix")
# Use Amatrix function to build pedigree matirx
ped.matrix<-Amatrix(ped, ploidy=2)
## -----------------------------------------------------------------------------------
# Read the Pedigree Data
ped<-read.csv(file="./Data/ped.finalv2.csv", header = TRUE)
setwd("~/Documents/Research/Workshops/IRRI_2025/Module2/Module2_Upload/Data")
## -----------------------------------------------------------------------------------
# Read the Pedigree Data
ped<-read.csv(file="./Data/ped.finalv2.csv", header = TRUE)
setwd("~/Documents/Research/Workshops/IRRI_2025/Module2/Module2_Upload/Data")
## -----------------------------------------------------------------------------------
# Read the Pedigree Data
ped<-read.csv(file="./Data/ped.finalv2.csv", header = TRUE)
## -----------------------------------------------------------------------------------
# Read the Pedigree Data
ped<-read.csv(file="ped.finalv2.csv", header = TRUE)
head(ped)
# Use Amatrix function to build pedigree matirx
ped.matrix<-Amatrix(ped, ploidy=2)
View(ped.matrix)
dim(ped.matrix)
ped.matrix[1:10,1:5]
## ----message=FALSE, warning=FALSE---------------------------------------------------
# Read SNP data
geno<-read.csv(file="geno.data.csv", header = TRUE, row.names = 1)
# Build the VanRaden 2008 G matrix
G_additive <- Gmatrix(SNPmatrix=geno, missingValue=NA,
maf=0.05, method="VanRaden")
## ----message=FALSE, warning=FALSE---------------------------------------------------
# Read SNP data
geno<-read.csv(file="geno.data.csv", header = TRUE, row.names = 1)
geno<-as.matrix(geno) # Convert as matrix
# Build the VanRaden 2008 G matrix
G_additive <- Gmatrix(SNPmatrix=geno, missingValue=NA,
maf=0.05, method="VanRaden")
## -----------------------------------------------------------------------------------
heatmap(G_additive)
## ----message=FALSE, warning=FALSE---------------------------------------------------
G_Dominace <- Gmatrix(SNPmatrix=geno, missingValue=NA,
maf=0.05, method="Su")
## -----------------------------------------------------------------------------------
heatmap(G_Dominace)
